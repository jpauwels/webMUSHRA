function checkOrientation(){var e=document.body.scrollWidth;$("#header").css("width",e.toString())}function addPagesToPageManager(e,a,n){var r=n;void 0===n&&(r=e.pages.length);for(var o,t,i,d=0;d<a.length;++d)Array.isArray(a[d])?("random"===a[d][0]&&(a[d].shift(),shuffle(a[d])),addPagesToPageManager(e,a[d],r)):"paired_comparison"==(i=a[d]).type?(r=(new PairedComparisonPageManager).createPages(e,pageTemplateRenderer,i,session,config.language,dataSender,audioContext,config.bufferSize,audioFileLoader,errorHandler,r),0):"bs1116"==i.type?(r=(new BS1116PageManager).createPages(e,pageTemplateRenderer,i,session,config.language,dataSender,audioContext,config.bufferSize,audioFileLoader,errorHandler,r),0):"likert_single_stimulus"==i.type?(r=(new LikertSingleStimulusPageManager).createPages(e,pageTemplateRenderer,i,session,config.language,dataSender,audioContext,config.bufferSize,audioFileLoader,errorHandler,r),0):("generic"==i.type?e.insertPage(new GenericPage(e,pageTemplateRenderer,i,session,config.language,dataSender),r):"volume"==i.type?(o=new VolumePage(e,pageTemplateRenderer,i,session,config.language,dataSender,audioContext,config.bufferSize,audioFileLoader,errorHandler),e.insertPage(o,r)):"mushra"==i.type?(t=new MushraPage(e,pageTemplateRenderer,i,session,config.language,dataSender,audioContext,config.bufferSize,audioFileLoader,errorHandler,mushraValidator),e.insertPage(t,r)):"spatial"==i.type?e.insertPage(new SpatialPage(e,pageTemplateRenderer,i,session,config.language,dataSender,audioContext,config.bufferSize,audioFileLoader,errorHandler),r):"likert_multi_stimulus"==i.type?(t=new LikertMultiStimulusPage(pageManager,pageTemplateRenderer,i,session,config.language,dataSender,audioContext,config.bufferSize,audioFileLoader,errorHandler),e.insertPage(t,r)):"finish"==i.type?(i=new FinishPage(e,pageTemplateRenderer,i,session,config.language,dataSender),e.insertPage(i,r)):(errorHandler.sendError("Page type not specified."),errorHandler.displayErrors()),++r)}window.onresize=function(e){pageManager.getCurrentPage()&&1==pageManager.getCurrentPage().isMushra&&pageManager.getCurrentPage().renderCanvas("mushra_items"),checkOrientation()};for(var i=0;i<$("body").children().length;i++)"popupErrors"!=$("body").children().eq(i).attr("id")&&"popupDialog"!=$("body").children().eq(i).attr("id")&&$("body").children().eq(i).addClass("ui-disabled");function startup(e){null==e&&(errorHandler.sendError("Configuration file couldn't be found!"),errorHandler.displayErrors()),$.mobile.page.prototype.options.theme="a",null!==pageManager&&(pageTemplateRenderer.clear(),$("#page_content").empty(),$("#header").empty()),(localizer=new Localizer).initializeNLSFragments(nls),document.title=e.testname,$("#header").append(document.createTextNode(e.testname)),pageManager=new PageManager("pageManager","page_content",localizer,errorHandler,e.stopOnErrors),window.AudioContext=window.AudioContext||window.webkitAudioContext,"undefined"!=typeof AudioContext?audioContext=new AudioContext:"undefined"!=typeof webkitAudioContext&&(audioContext=new webkitAudioContext),document.addEventListener("click",function(){"running"!==audioContext.state&&audioContext.resume()},!0);try{audioContext.destination.channelCountMode="explicit",audioContext.destination.channelInterpretation="discrete",audioContext.destination.channelCount=audioContext.destination.maxChannelCount}catch(e){console.log("webMUSHRA: Could not set channel count of destination node."),console.log(e)}audioContext.volume=1,audioFileLoader=new AudioFileLoader(audioContext,errorHandler),mushraValidator=new MushraValidator(errorHandler),dataSender=new DataSender(e,pageManager,errorHandler),(session=new Session).testId=e.testId,session.config=configFile,null==e.language&&(e.language="en"),pageTemplateRenderer=new PageTemplateRenderer(pageManager,e.showButtonPreviousPage,e.language),pageManager.addCallbackPageEventChanged(pageTemplateRenderer.refresh.bind(pageTemplateRenderer)),addPagesToPageManager(pageManager,e.pages),pageManager.start(),!1!==e.showProgressBar&&pageTemplateRenderer.renderProgressBar("page_progressbar"),pageTemplateRenderer.renderHeader("page_header"),pageTemplateRenderer.renderNavigation("page_navigation"),$.mobile.activePage&&$.mobile.activePage.trigger("create")}function getParameterByName(e){e=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return e&&decodeURIComponent(e[1].replace(/\+/g," "))}var config=null,configArg=getParameterByName("config"),configFile="",configFile=configArg?"configs/"+configArg:"configs/default.yaml",errorHandler=new ErrorHandler,localizer=null,pageManager=null,audioContext=null,audioFileLoader=null,mushraValidator=null,dataSender=null,session=null,pageTemplateRenderer=null;YAML.load(configFile,function(e){startup(config=e)});